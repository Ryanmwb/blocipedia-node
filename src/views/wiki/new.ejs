<!DOCTYPE html>
<html>
  <head>
    <% include ../static/partials/head.ejs %>
  </head>
  <body>
    <% include ../static/partials/navbar.ejs %>

    <main class="container">

      <% include ../static/partials/messages.ejs %>

      <% if(currentUser) { %>
        <h1>New Wiki</h1>

        <form action="/wikis/create" method="post">
          <div class="form-group">
            <label for="title">Wiki title</label>
            <input type="text" class="form-control" name="title" aria-describedby="titleHelp" placeholder="Enter Title">
            <small class="text-muted" id="titleHelp">title must be at least 4 characters long</small>
          </div>
          <div class="form-group">
            <label for="body">Wiki body</label>
            <textarea  oninput="this.editor.update()"
              rows="4" class="form-control" name="body" placeholder="Enter Post body">Type **Markdown** here.</textarea>
            <small class="text-muted" id="bodyHelp">body must be 10 or more characters in length.</small>
            <div id="preview"> </div>
            <script src="lib/markdown.js"></script> 
            <script>
              function Editor(input, preview) {
                this.update = function () {
                  preview.innerHTML = markdown.toHTML(input.value);
                };
                input.editor = this;
                this.update();
              }
              var $ = function (id) { return document.getElementById(id); };
              new Editor($("text-input"), $("preview"));
            </script> 
          </div>
          <% if(currentUser.role > 0) { %>
            <div class="btn-group btn-group-toggle" data-toggle="buttons">
                <label class="btn btn-secondary active">
                    <input type="radio" name="privacy" autocomplete="off" value="public" checked> Public
                </label>
                <label class="btn btn-secondary">
                    <input type="radio" name="privacy" id="option2" autocomplete="off" value="private"> Private
                </label>
            </div>
          <% } %>
          <br>
          <br>
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
      <% } else { %>
        <header class="jumbotron my-4">
          <h1 class="display-3">You must be signed in to downgrade your account your account.</h1>
          <a href="/users/signIn" class="btn btn-primary btn-lg">Sign In</a>
        </header>
      <% } %>

    </main>

    <% include ../static/partials/baseScripts.ejs %>

  </body>
</html>